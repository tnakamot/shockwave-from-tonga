# Visualization of Shockwave from Tonga

The animation below shows the shockwave generated by the massive volcanic eruption in Tonga. Dots in the map of Japan below represent the barometric pressure difference from 10 minutes ago.

## First shockwave directly coming from Tonga

This animation clearly shows that the shockwave from Hunga Tonga ([20°32'09.6"S 175°22'55.2"W](https://geohack.toolforge.org/geohack.php?params=20.536_S_175.382_W)). The arrival time at Kyoto was about January 15, 2022 08:30 PM (JST), which is about 7 hours and 15 minutes later than [the even of the erruption of Hunga Tonga](https://en.wikipedia.org/wiki/2022_Hunga_Tonga_eruption_and_tsunami). Kyoto is approximately 8,000 km away from Hunga Tonga. This means that the shockwave was propagated at a speed of about 307 m/s, which is almost equal to the speed of sound.

![First shockwave](figure_jma/shockwave_0.gif)

## Second shockwave from the opposite side

The second shockwave came from the opposite side. This is the wave that went through the other side of Tonga of the Earth ([20°32'09.6"N 4°37'4.8"E, somewhere in South Africa](https://geohack.toolforge.org/geohack.php?params=20.536_N_4.618_E)). The circumference of the Earth is about 40,000 km, so this wave should have traveled for about (40,000 - 8,000) = 32,000 km. The arrival time of this second shockwave at Kyoto was about January 16, 2022 05:20 PM (JST), which is about 28 hours later than the erruption. This indicates that the propagation speed was about 317 m/s. Note that this is a quick esimation, so may be different from the actual speed.

![Second shockwave](figure_jma/shockwave_1.gif)

## Third shockwave from Tonga again

The third shockwave came in the same direction as the first one. This is the wave that went around the globe all the way and came from Tonga again. The arrival time at Kyoto is about January 17, 2022 09:00 AM (JST), which is about 1 and half days after the first shockwave. Because the circumference of the Eeath is about 40,000 km, we can estimate that the speed of this shockwave is about 309 m/s. This result is consistent with the previous calculation.

![Third shockwave](figure_jma/shockwave_2.gif)

## How To

The barometric pressure data were obtained from [Japan Meteorological Agency](https://www.data.jma.go.jp/obd/stats/etrn/index.php). The good thing about their database is that they monitor the barometric pressure every 10 minutes at major weather stations and preserve them in the database.

To reproduce the same images above, you need Python 3.8 (or above) and the following python modules:

 * tqdm (version 4.30 or newer)
 * BeautifulSoup (version 4.8.2 or newer)
 * numpy (version 1.1.17.4 or newer)
 * matplotlib (version 3.1.2 or newer)
 * cartopy (0.17.0 or newer)
 * geopy (1.20.0 or newer)
 * OpenCV (4.2.0 or newer)
 * Pillow (9.0.0 or newer)

 
On Ubuntu 20.04, the above packages except Pillow can be obtained through `apt`:

```
 $ sudo apt install python3 python3-pip python3-bs4 python3-matplotlib python3-cartopy python3-geopy python3-opencv
```

The Pillow nees to be installed via `pip` to obtain a new version:

```
 $ python3 -m pip install Pillow
```
 
Then, run the commnad below to download the barometric pressure data from JMA:

```
 $ python3 collect_data_from_jma.py
```

The downloaded data will be saved in `data_jma/` directory as CSV files. Run the command below to generate maps with the data plot:

```
 $ python3 draw_map_japan.py
```

The animation GIFs will be saved in `figure_jma/` directory.

### Wavefront Simulation

The animation below shows the simulated wavefront of the shockwave from Hunga Tonga assuming the travel speed is 300, 305, 310, 315, and 320 m/s.

https://user-images.githubusercontent.com/3995187/150633918-a81b4861-b6f1-457d-91fb-c05d861ed9ac.mp4

Run the command below to reproduce this video:

```
 $ python3 wavefront_simulation.py
```

This generates `figure_wavefront_simulation/wavefront_simulation.gif` and `figure_wavefront_simulation/wavefront_simulation.mp4`. The MP4 codec used by this script is not the best in terms of file size. To compress the MP4 file further, it is recommended to use H264 encoder. For example, if you are using Ubuntu 20.04, run the commands below to do so:

```
 $ sudo apt install x264
 $ x264 -o figure_wavefront_simulation/wavefront_simulation_h264.mp4 figure_wavefront_simulation/wavefront_simulation.mp4
```

Note that this script uses `geopy.distance.geodesic()` method to calculate the distance from Hunga Tonga to any points on the Earth. According to the [GeoPy's documentation](https://geopy.readthedocs.io/en/v1/#module-geopy.distance), it uses the method given by [Kerney (2013)](https://doi.org/10.1007%2Fs00190-012-0578-z) and [WGS-84](https://en.wikipedia.org/wiki/World_Geodetic_System) ellipsoidal model.

## Acknowledgement

Visualization of the barometric pressure difference to see the shockwave was originally done by Weathernews Inc.

 * [トンガでの火山噴火による衝撃波か日本各地で急激な気圧変化](https://weathernews.jp/s/topics/202201/150195/)
 * [トンガ火山噴火による衝撃波が地球1周して再来か　今朝も各地で気圧変化](https://weathernews.jp/s/topics/202201/170085/)

They have used their own measurement instruments while I am using data from Japan Meteorological Agency.
